<!DOCTYPE html>
<html>
<head>
	<title>EssenceJS test</title>
	<meta charset="UTF-8" />
	<meta name="author" content="Maximilian Berkmann" />
	<meta name="pragma" content="no-cache" />
	<meta name="viewport" content="width=device-width, initial-scale=1" />
	<script type="text/javascript" src="1.1/essence.js"></script>
	<script defer>
	var bodyBg, ba, r, g, b, csl, lr;

	function start () {
		//noinspection JSValidateTypes
		Essence.say("Welcome !!", "succ");
		//if (typeof(conv) != "function" || !isType(Colour, "Object") || !isType(Console, "Object") || !isType(virtualHistory, "Object")) startT = setTimeout("start();", 100);
		//else clearTimeout(startT);
		bodyBg = new Colour(255); ba = new Colour(0); r = new Colour(255, 0, 0); g = new Colour(0, 255, 0); b = new Colour(0, 0, 255);
		csl = new Console();
		try {
			csl.place("csl");
		} catch (e) {
			Essence.say("Hum !!");
		}
		lr = $G["lorem"].replace(/(\.|!|\?|;|:|"|,|\t|\n|\f|\r|\v|\{|})+/gm, " ").split(" ").remove();
		writeMsg2($G["lorem"].chunk(0, 7), "#test", false, 50);
		daynightMode(true);
		$e("title").write("EssenceJS v" + Essence.version + " test");
	}

	function inn (stackLayer) {
		if (typeof Essence !== "undefined") { //Use EssenceJS
			start();
		} else if (stackLayer > 3) {
			console.log("Wow, hold on ! %d stack layers down !!", stackLayer);
			setTimeout("inn()", 5);
		} else {
			inn(stackLayer? stackLayer + 1: 1);
			console.warn("EssenceJS is not currently available !");
		}
	}

	function effect () {
		$e("body").setCSS("background", bodyBg.hex);
		$e("#ba").setCSS("color", ba.hex);
		$e("#r").setCSS("color", r.hex);
		$e("#g").setCSS("color", g.hex);
		$e("#b").setCSS("color", b.hex);
	}
	function effect3 () {
		$e("body").setCSS("background", "#fff");
		$e("#ba").setCSS("color", "#000");
		$e("#r").setCSS("color", "#000");
		$e("#g").setCSS("color", "#000");
		$e("#b").setCSS("color", "#000");
	}
	function effect2 () {
		bodyBg.negative();
		ba.negative();
		r.negative();
		g.negative();
		b.negative();
		$e("body").setCSS("background", "#000");
		$e("#ba").setCSS("color", "#fff"||ba.hex);
		$e("#r").setCSS("color", r.hex);
		$e("#g").setCSS("color", g.hex);
		$e("#b").setCSS("color", b.hex);
	}
	//var root, root0, root1, root2;
	function simpleNodes () {
		/*root = new TreeNode(0, new TreeNode(1, new TreeNode(3, new TreeNode(7), new TreeNode(8)), new TreeNode(4, new TreeNode(9), new TreeNode(10))),
			new TreeNode(2, new TreeNode(5, new TreeNode(11), new TreeNode(12)), new TreeNode(6, new TreeNode(13), new TreeNode(14))));
		root0 =  new TreeNode(0, new TreeNode(1, new TreeNode(2, new TreeNode(3), new TreeNode(4)), new TreeNode(5, new TreeNode(6), new TreeNode(7))),
			new TreeNode(8, new TreeNode(9, new TreeNode(10), new TreeNode(11)), new TreeNode(12, new TreeNode(13), new TreeNode(14))));
		root1 =  new TreeNode(0, new TreeNode(2, new TreeNode(1, new TreeNode(3), new TreeNode(4)), new TreeNode(6, new TreeNode(5), new TreeNode(7))),
			new TreeNode(8, new TreeNode(10, new TreeNode(9), new TreeNode(11)), new TreeNode(12, new TreeNode(14), new TreeNode(13))));
		root2 =  new TreeNode(0, new TreeNode(2, new TreeNode(4, new TreeNode(6), new TreeNode(8)), new TreeNode(10, new TreeNode(12), new TreeNode(14))),
			new TreeNode(1, new TreeNode(3, new TreeNode(5), new TreeNode(7)), new TreeNode(9, new TreeNode(11), new TreeNode(13))));
		
		println("<fieldset><b>Root</b><br />Pre order: ("+root.getPreOrder()+")");
		root.preOrder();
		println("In order: ("+root.getInOrder()+")");
		root.inOrder();
		println("Post order: ("+root.getPostOrder()+")");
		root.postOrder();
		println("<b>Root 0</b><br />Pre order: ("+root0.getPreOrder()+")");
		root0.preOrder();
		println("In order: ("+root0.getInOrder()+")");
		root0.inOrder();
		println("Post order: ("+root0.getPostOrder()+")");
		root0.postOrder();
		println("<b>Root 1</b><br />Pre order: ("+root1.getPreOrder()+")");
		root1.preOrder();
		println("In order: ("+root1.getInOrder()+")");
		root1.inOrder();
		println("Post order: ("+root1.getPostOrder()+")");
		root1.postOrder();
		println("<b>Root 2</b><br />Pre order: ("+root2.getPreOrder()+")");
		root2.preOrder();
		println("In order: ("+root2.getInOrder()+")");
		root2.inOrder();
		println("Post order: ("+root2.getPostOrder()+")");
		root2.postOrder();
		print("</fieldset>", true);*/
	}
	
	function postHTMLinit () {
		inn();
		Essence.init();
		if(isNon($n("#btn"))){
			Essence.say("I couldn't find the node #btn !\The element is the following:\n"+$e("#btn"));
			Essence.say("$e('#btn').node= "+$e("#btn").node, "info");
		}else $e("#btn").on('click', function(event){evtLog(event);EvtShow(event);});
		simpleNodes();
	}
	
	function testDL () {
		CECheck("ceval");
		if ($e("#ceval").val() != "Click on me to test your download speed.") WiFi();
	}

	function WiFi () {
		var sp = (getNumFromStr($e("#ceval").val().split("(")[1]) / 8).toNDec(3) + " Ko/s";
		Essence.say("Down: " + sp, "info");
		$e("#cnx").write(sp + " Ko/s");
		if ($e("#cnx").val() === "0 Ko/s" || $e("#cnx").val() == "0" || $e("#cnx").val() != sp) $n("#cnx").innerHTML = sp;
	}

	function lineTest (b, c) {
		b();
		Essence.say("line: " + getLineNum(b));
		c();
	}
	</script>
</head>
<body onpageshow='postHTMLinit();lineTest(function () { Essence.say("Inb4 !! " + getLineNum()) }, function () { Essence.say("Callback ! " + getLineNum()) });' onload='Essence.preInit();'>
	<h4 onmouseover="DocTemplate.associateAll();DocTemplate.fullDeMustache()">You're using <em data-essence>Essence</em></h4>
	<span id="test" onmouseover="Essence.applyCSS(true)" data-lorem="Hiii"></span>
	<div id="ColourTest" onMouseover='effect()' onClick="effect2()" onMouseout="effect3()">
		<span id='ba'>Black</span> <span id='r'>Red</span> <span id='g'>Green</span> <span id='b'>Blue</span>
	</div><br />
	<form>
		<input type="button" value="event" id="btn" />
	</form>
	<br /><span id="ceval" onclick="testDL()">Click on me to test your download speed.</span> &rArr; <span id="cnx" onclick="WiFi()">0</span>
	<br /><div id="csl">Console !</div>
	<p>Timestamp: {{timestamp}}</p>
</body>
</html>
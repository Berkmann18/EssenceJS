function xor(r,t){return r&&!t||!r&&t}function timesLiteral(r){switch(r){case 1:return"once"
case 2:return"twice"
default:return r+" times"}}function rand(r,t,e){return e?Math.floor(Math.random()*(t-r+1)+r):Math.random()*(t-r+1)+r}function randTo(r){return rand(0,r,!0)}function baseRand(r,t,e){return parseInt(rand(r,t)).toString(e||10)}function randVar(r,t,e){var n=Math.max(r,t),a=Math.min(r,t)
return rand(a,n,e)}function lenRand(r,t){return t?Math.floor(Math.random()*(r+1)):Math.floor(Math.random()*r)}function random16(){return(65280*Math.random()+255*Math.random())/65535}function randFloatSpread(r){return r*(.5-Math.random())}function randNum(r,t,e,n,a){for(var o=[],i=0;(r||10)>i;i++)o[i]=a?conv(rand(t||0,e||100,!n||!0),10,a):rand(t||0,e||100,!n)
return o}function genNearlySortedArr(r,t,e){var n,a=range(t,1,e).slice(0,r),o=[]
n=a.getIncrement(0)
for(var i=0;i<a.length;i++){var u=randTo(n)
o.push(a[i]),i>0&&0===u?swap(o,i,i-1):i>1&&u===n&&swap(o,i,i-2)}return o}function sumPow2(r,t){if(!isType(r,"Array"))return!1
for(var e=0,n=0;n<r.length;n++)e+=Math.pow(r[n],2)
return e.toNDec(t)}function conv(r,t,e,n){return n?parseFloat(r,t||2).toString(e||10):parseInt(r,t||2).toString(e||10)}function negateBin(r,t){for(var e=[],n=0,a=0;a<r.length;a++)e[a]=1-parseInt(r[a])
return n=conv(e.join("")),n++,t?conv(n,10,2).split(""):conv(n,10,2)}function floatingPtBin(r){var t,e,n=1===r[0]?-1:1,a=function(r,t){for(var e=0,n=0;t>n;n++)e+=parseInt(r[n])*Math.pow(2,-n-1)
return e}
switch(r.length){case 8:t=(1===r[1]?1:-1)*conv(r.get(2,4)),e=a(r.get(5),3)
break
case 16:t=(1===r[1]?1:-1)*conv(r.get(2,6)),e=a(r.get(7),9)
break
case 32:t=(1===r[1]?1:-1)*conv(r.get(2,8)),e=a(r.get(9),23)
break
case 64:t=(1===r[1]?1:-1)*conv(r.get(2,11)),e=a(r.get(12),52)
break
case 128:t=(1===r[1]?1:-1)*conv(r.get(2,14)),e=a(r.get(15),112)
break
default:throw new Error("Invalid binary number")}return n*Math.pow(2,t)*e}function min2dec(r){return 50*r/30}function dec2min(r){return 30*r/50}function toS(r){if(r==parseFloat(r))return parseFloat(r)
var t=2===r.count(":")
if(r||(r=t?"00:00:00.000":"00:00.000"),isType(r,"String")||(r+=""),r.length>=4&&1==r.indexOf(":"))return toS("0"+r)
var e=r.split(":")
if(t){var n,a,o
return n=parseInt(e[0]),a=parseInt(e[1]),o=parseFloat(e[2]),3600*n+60*a+o.toNDec()}return a=parseInt(e[0]),o=parseFloat(e[1]),60*a+o}function sec2time(r,t){var e=0,n=0,a=r
return t?(a=(r%60).toNDigits(),e=r>=3600?Math.floor(r/3600):0,n=Math.floor((r-a-3600*e)/60),n=0>=n?"00":n.toNDigits(),e=0>=e?"00":e.toNDigits(),e+":"+n+":"+a.get(0,Math.min(4,a.length-1))):(a=(r%60).toNDigits(),n=Math.floor(r/60).toNDigits(),0>=n?a:n+":"+a.get(0,Math.min(4,a.length-1)))}function markConv(r,t,e,n){return(r/t*(e||100)).toNDec(n||2)}function nthroot(r,t,e){for(var n=r/2,a=0;60>a;a++)n+=(r-Math.pow(n,t))/(Math.pow(n+1,t)-Math.pow(n,t))
return n.toNDec(e||20)}function log(r,t){return Math.log(r)/Math.log(t||10)}function ln(r){return log(r,Math.E)}function gcd(r,t){return t?gcd(t,r%t):Math.abs(r)}function Bin(r,t,e){return C(r,e)*Math.pow(t,e)*Math.pow(1-t,r-e)}function BinCumul(r,t,e){for(var n=[],a=0;e>a;a++)n.push(Bin(r,t,e))
return n.sum()}function BinCumulLT(r,t,e){for(var n=1-t,a=r-e,o=e+1,i=a+o-1,u=0,c=a;i+1>c;c++)u+=factorial(i)/(factorial(c)*factorial(i-c))*Math.pow(n,c)*Math.pow(1-n,i-c)
return u}function Norm(r){var t=1/(1+.2316419*Math.abs(r)),e=.3989423*Math.exp(-r*r/2),n=e*t*(.3193815+t*(-.3565638+t*(1.781478+t*(-1.821256+1.330274*t))))
return n.toNDec(4)}function StdNorm(r,t,e){return Norm((e-r)/t)}function InvNorm(r){var t,e=[2.50662823884,-18.61500062529,41.39119773534,-25.44106049637],n=[-8.4735109309,23.08336743743,-21.06224101826,3.13082909833],a=[.3374754822726147,.9761690190917186,.1607979714918209,.0276438810333863,.0038405729373609,.0003951896511919,321767881768e-16,2.888167364e-7,3.960315187e-7],o=r-.5,i=Math.abs(o),u=o*o
return.42>i?t=o*(((e[3]*u+e[2])*u+e[1])*u+e[0])/((((n[3]*u+n[2])*u+n[1])*u+n[0])*u+1):(t=Math.log(-Math.log(o>0?1-r:r)),t=a[0]+t*(a[1]+t*(a[2]+t*(a[3]+t*(a[4]+t*(a[5]+t*(a[6]+t*(a[7]+t*a[8]))))))),0>o&&(t=-t)),t}function Po(r,t){return Math.exp(-r)*Math.pow(r,t)/factorial(t).toNDec(4)}function PoCumul(t,e){for(var n=[],a=0;a<r;a++)n.push(Po(t,e))
return n.sum()}function factorial(r){for(var t=r,e=1;r>e;e++)t*=e
return t}function C(r,t){return factorial(r)/(factorial(t)*factorial(r-t))}function Bin2Norm(r,t,e,n){return r*t>5&&r*(1-t)>5?(e+=">="===n?-.5:.5,StdNorm(r*t,Math.sqrt(r*t*(1-t)),e)):!1}function Bin2Po(r,t,e){return r>50&&.1>t?Po(r*t,e):!1}function Po2Norm(r,t){return r>10?StdNorm(t,Math.sqrt(t)):!1}function erf(r){var t,e=1/(1+.5*Math.abs(r))
return t=1-e*Math.exp(-r*r-1.26551223+e*(1.00002368+e*(.37409196+e*(.09678418+e*(-.18628806+e*(.27886807+e*(-1.13520398+e*(1.48851587+e*(-.82215223+.17087277*e))))))))),r>0?t:-t}function NormEstimate(r,t,e){var n,a=r*t
return n=Math.pow(a*(1-t),.5),.5*(1+erf((e-a)/(n*Math.pow(2,.5))))}function clamp(r,t,e){return t>r?t:r>e?e:r}function revClamp(r,t,e){return r>=t&&e>=r?getClosest(r,[t,e]):r}function clampBottom(r,t){return t>r?t:r}function clampTop(r,t){return r>t?t:r}function abcClamp(r){return 32===r?32:revClamp(clamp(r,65,122),90,97)}function mapLinear(r,t,e,n,a){return n+(r-t)*(a-n)/(e-t)}function deg2rad(r){return r*Math.PI/180}function rad2deg(r){return 180*r/Math.PI}function cels2fahr(r){return 33.8*r}function fahr2cels(r){return r/33.8}function primeN(r){for(var t=r.quickSort(),e=0;e<r.length;e++){r[e]%2===0&&2!=r[e]&&(t[e]="x")
for(var n=0;e>n;n++)primeCheck(t[n],t[e])&&(t[e]="x")}return t.remove("x")}function primeCheck(r,t){return r>1&&t>1&&t%r===0&&t!=r}function getClosestRoot(r,t){t||(t=2)
var e=0,n=0
if(e=r>=r/2*r/2/2-2?r/2:r>=r/3*r/3?r/3:r/4,Math.pow(e,t)===r)return e
for(var a=1;t>=a;a++)for(var o=1;r>o;o++)Math.pow(o,a)===r||Math.pow(o,a-1)*o===r?n=o:(Math.pow(o,a)>r||Math.pow(o,a-1)*o>r)&&(n=o-.5)
if(Math.pow(n,t)<=r)return n
n=(Math.pow(t,-2)+r/Math.pow(t,4)-r/Math.pow(t,5)+Math.pow(r,t)/Math.pow(t,Math.pow(t,3)+3)+r/Math.pow(t,2))/2,Math.pow(n,t)>r&&(n=(n+e)/2)
var i=[e,n,(r/n+n)/2,(n+e)/2],u=i.map(function(r){return Math.pow(r,t)})
return.9956973041*i[u.lookFor(getClosest(r,u))]}function simpleInterest(r,t,e){return r*(1+t*(e||1))}function compoundInterest(r,t,e,n){return n>1?r*Math.pow(1+t/n,(e||1)*n):r*Math.pow(1+t,e||1)}function non0(r){return 0===r?Essence.eps:r}function toFrac(r,t,e){var n=String(r),a=n.indexOf(".")
if(-1==a)return n
var o=Math.floor(r)||"",i=n.substring(a),u=t||Math.pow(10,i.length-1),c=e?Math.ceil(i*u):Math.round(i*u),s=u,f=gcd(c,s)
return s/f===1?String(o+c/f):(o&&(o+=" and "),o+String(c/f)+"/"+String(s/f))}function clearNum(r,t,e){for(var n=(Math.floor(r)+"").length/3,a="",o=0;n>o;o++)a=(r-r%Math.pow(1e3,o))%Math.pow(1e3,o+1)/Math.pow(1e3,o)+" "+a
return a=a.split(" "),a.pop(),a.join(e?",":" ")+(r%1).toNDec(t||3)}function getStep(r,t,e){return[r,t].getIncrement(e)}function quadraticSolver(r,t,e,n){var a=Math.sqrt(t,2)-4*r*e
return 0===a?(-t/(2*r)).toNDec(n):[((-t-Math.sqrt(Math.abs(a)))/(2*r)+(0>a?"i":0)).toNDec(n),(-t+Math.sqrt(Math.abs(a)))/(2*r)+(0>a?"i":0).toNDec(n)]}function eqSolver(formula,res,a,b){a=a||-100,b=b||200
var r=mkArray(a>0?b-a:b-a+1,2,1)
if(formula.search(/\^[0-9]/g)>0){var expr="([(]. * ?[)]|\\d + \\.\\d + |\\d + |[a-z] + )",reg=RegExp(expr+"\\^"+expr)
formula=formula.replace(reg,"Math.pow($1, $2)")}else formula.search(/e\^/g)>0&&(expr="([(]. * ?[)]|\\d + \\.\\d + |\\d + |[a-z] + )",reg=RegExp("e\\^"+expr),formula=formula.replace(reg,"Math.exp($1)"))
Essence.say("Formula now converted to %c"+formula,"info","color: #00f;")
for(var x=a;b>=x;x++)for(var y=a;b>=y;y++)r[x][y]="("+x+","+y+") "+eval(formula)
return r.filter(function(r){return r.split(") ")[1]==res?r.split(") ")[0]+")":void 0})}function manuEqSolver(eq,max,dim,r){for(var res=mkArray(max+1,dim,1),p=[],x=0;x<res.length;x++)if(2===dim)for(var y=0;y<res.length;y++)res[x][y]=eval(eq),res[x][y]===r&&p.push("x = "+x+", y = "+y)
else if(3===dim)for(y=0;y<res.length;y++)for(var z=0;z<res.length;z++)res[x][y][z]=eval(eq),res[x][y][z]===r&&p.push("x = "+x+", y = "+y+", z = "+z)
else res[x]=eval(eq),res[x]===r&&p.push("x = "+x)
return p}function getNumFromStr(r){return parseFloat(r.replace(/[A-Za-z_ ]+/g,""))}function toPixel(r){var t=1
switch(r.substring(String(getNumFromStr(r)).length,r.length)){case"em":t=16
break
case"km":t=3779527.5593333
break
case"hm":t=377952.75593333
break
case"m":t=3779.5275593333
break
case"dm":t=377.95275593333
break
case"cm":t=37.795275593333
break
case"mm":t=3.7795275593333
break
case"ɥm":t=.0037795275593333
break
case"nm":t=37795275593333e-19
break
case"ex":t=7.156
break
case"in":t=96
break
case"pt":t=1.3333333333333
break
case"pc":t=16
break
case"ft":t=1152
break
case"twip":t=15
break
case"mi":t=6082636.631643
break
case"yd":t=3456.043540706}return getNumFromStr(r)*t}function fromPixel(r,t){var e=1
switch(t){case"em":e=1/16
break
case"km":e=1/3779527.5593333
break
case"hm":e=1/377952.75593333
break
case"m":e=1/3779.5275593333
break
case"dm":e=1/377.95275593333
break
case"cm":e=1/37.795275593333
break
case"mm":e=.2645833333138594
break
case"ɥm":e=264.5833333138594
break
case"nm":e=264583.3333138594
break
case"ex":e=1/7.156
break
case"in":e=1/96
break
case"pt":e=.7500000000000188
break
case"pc":e=1/16
break
case"ft":e=1/1152
break
case"twip":e=1/15
break
case"mi":e=1/6082636.631643
break
case"yd":e=1/3456.043540706}return r*e+t}function convUnit(r,t){return fromPixel(toPixel(r),t)}function range(r,t,e,n){var a=[],o=0
if(r&&!t&&!e&&0!=e)return range(0,1,r)
if(r&&t&&!e&&0!=e)return range(0,t,r)
if(r||(r=0),t||(t=1),e||(e=100),t>0)for(var i=r;e>=i;i+=t)a[o++]=Number(i).toNDec(n)
else for(i=r;i>=e;i-=t)a[o++]=Number(i).toNDec(n)
return a}function range2base(r,t,e,n){var a=[],o=0
if(t>0)for(var i=r;e>=i;i+=t)a[o++]=conv(i,10,n)
else for(i=r;i>=e;i+=t)a[o++]=conv(i,10,n)
return a}function mixedRange(r,t,e,n){var a=[],o=range(r,t,e)
if(n)for(;o.length>0;)a.push(o.rand()),o=o.remove(a.last())
else for(var i=r;e>=i;i++)a[i]=o.rand()
return a.remove(void 0)}function fisherYatesShuffle(r){for(var t=r.length;t>0;)r.hasOwnProperty(t)&&swap(r,t,Math.floor(Math.random()*t--))
return r}function vectorProd(r,t){var e=[],n=[0,0,0]
return e[0]=["i","j","k"],e[1]=[r.x,r.y,r.z],e.last([t.x,t.y,t.z]),n[0]=r.y*t.z-r.z*t.y,n[1]=r.x*t.z-r.z*t.x,n.last(r.x*t.y-r.y*t.x),n[0]+"i + "+n[1]+"j + "+n.last()+"k"}function vector2Point(r){return new Pt(r.x,r.y,r.z)}function vector2PointForm(r){return"("+r.split("i")[0].clean()+", "+r.split("i")[1].split("j")[0].slice(1,r.split("i")[1].split("j")[0].length).clean()+", "+r.split("i")[1].split("j")[1].split("k")[0].clean()+")"}function scalarProd(r,t){return r.x*t.x+r.y*t.y+r.z*t.z}function union(r,t,e,n){return n?rmDuplicates(r.concat(t,e)).quickSort():rmDuplicates(r.concat(t,e))}function intersection(r,t,e,n){var a=[]
r=r.quickSort(),t=t.quickSort(),e=e?e.quickSort():!1
for(var o in r)r.hasOwnProperty(o)&&(t.has(r[o])&&isNon(e)?a.push(r[o]):t.has(r[o])&&e.has(r[o])&&a.push(r[o]))
return n?rmDuplicates(a).quickSort():rmDuplicates(a)}function complement(r,t,e,n){var a=[]
r=r.quickSort(),t=t.quickSort(),e=e?e.quickSort():!1
for(var o in r)r.hasOwnProperty(o)&&(-1===t.indexOf(r[o])&&isNon(e)?a.push(r[o]):-1===t.indexOf(r[o])&&-1===e.indexOf(r[o])&&a.push(r[o]))
return n?rmDuplicates(a).quickSort():rmDuplicates(a)}function symDif(r,t,e,n){var a=[]
r=r.quickSort(),t=t.quickSort(),e=e?e.quickSortort():!1
for(var o in r)r.hasOwnProperty(o)&&(-1===t.indexOf(r[o])&&isNon(e)?a.push(r[o]):-1===t.indexOf(r[o])&&-1===e.indexOf(r[o])&&a.push(r[o]))
for(o in t)t.hasOwnProperty(o)&&(-1===r.indexOf(t[o])&&isNon(e)?a.push(t[o]):-1===r.indexOf(t[o])&&-1===e.indexOf(t[o])&&a.push(t[o]))
if(e)for(o in e)e.hasOwnProperty(o)&&-1===r.indexOf(e[o])&&-1===t.indexOf(e[o])&&a.push(e[o])
return n?rmDuplicates(a).quickSort():rmDuplicates(a)}function bitStr(r,t){var e=[]
for(var n in r)r.hasOwnProperty(n)&&(e[n]=r[n]===t[n]?1:0)
return e}function equivalent(r,t){return Math.round(r)===Math.round(t)||Math.floor(r)===Math.floor(t)||Math.ceil(r)===Math.floor(t)||Math.floor(r)===Math.ceil(t)}function approxEqual(r,t,e){return e||(e=Essence.eps),r>=t-e&&t+e>=r||t>=r-e&&r+e>=t}function P(r,t){return r.map(function(r){truth.push(Boolean(t.replace(/x/gm,r)))}),truth}function forAll(r,t){for(var e=!0,n=0;n<r.length;n++)if(e&=t.replace(/x/gm,r[n]),!e)return!1
return!!e}function forSome(r,t){for(var e=t.replace(/x/gm,r[0]),n=1;n<r.length;n++)if(e&=t.replace(/x/gm,r[n]))return!0
return!1}function forOne(r,t){return 1===P(r,t).count(!0)}function readCoord(r,t){var e=r.slice(1,r.length-1).split(", ")
return t?[parseInt(e[0]),parseInt(e[1])]:e}function modRange(r,t,e){var n=r%(e+1)
return n+(t>n)?t+n:0}function abcModulus(r){var t=r%123
return t>90&&97>t?t+abcModulus(Math.abs(getClosest(t,[90,97])-t)):t+(65>t&&32!=t?65+t:0)}function bruteForceNum(min,cond,max){for(var x=min;max>x;x++)if(eval(cond.replace(RegExpify("x"),x+"")))return x
return!1}function isCloser(r,t,e){return Math.abs(r-t)<Math.abs(r-e)}function getClosest(r,t){for(var e=t[0],n=1;n<t.length;n++)e=isCloser(r,e,t[n])?e:t[n]
return e}function Equation(formula){return this.formula=formula.normal()||"y=x",this.leftSide=this.formula.split("=")[0],this.rightSide=this.formula.split("=")[1],this.compute=function(data){return eval(this.rightSide.multiReplace([[/x/g,data.x||0],[/y/g,data.y||0],[/z/g,data.z||0],[/pi/gi,Math.PI],[/e/gi,Math.E],[/sqrt(2)/gi,Math.SQRT2],[/(pow|max|min)\((.*?),(.*?)\)/,"Math.$1($2, $3)"],[/(sqrt|cbrt|cos|sin|tan|acos|asin|cosh|sinh|tanh|acosh|asinh|atanh|exp|abs|e\^)\((.*?)\)/,"Math.$1($2)"],[/(ln|log|nthroot|clampTop|clampBottom)\((.*?),(.*?)\)/,"$1($2, $3)"],[/(clamp)\((.*?),(.*?),(.*?)\)/,"$1($2, $3, $4)"]]))},this.toString=function(){return"Equation("+this.formula+")"},this}function binaryCases(r){var t=parseInt("1".repeat(r)),e=[],n=0
do e.push(conv(n++,10,2))
while(n<=conv(t))
return e}function truthTable(exp){for(var ascii=asciiTable("a-z"),vars=[],rows,res=[],i=0;i<ascii.length;i++)exp.has(ascii[i])&&vars.push(ascii[i])
for(Essence.say("variables: "+vars.toStr(!0),"info"),rows=binaryCases(vars.length),i=0;i<rows.length;i++){for(var cexp=exp,j=0;j<vars.length;j++)cexp=cexp.multiReplace([[vars[j],rows[i][j]]])
Essence.say("current exp: "+cexp,"info"),res.push(eval(cexp))}return[vars,rows,res]}function getDNF(r){var t=(truthTable(r),"")
return t}function getCNF(r){var t=(truthTable(r),"")
return t}function timeCI(r,t,e){return[r+InvNorm(t/200)*e/Math.sqrt(t),r-InvNorm(t/200)*e/Math.sqrt(t)]}function sampleMean(r){return Math.sqrt(sumPow2(r)/r.length-r.mean())}function confidenceInterval(r,t,e,n){var a=InvNorm(e||.95)
return[r-a*n/Math.sqrt(t),r+a*n/Math.sqrt(t)]}function CI(r){return timeCI(r.mean(),r.length,r.stddev())}var Maths=new Module("Maths","Maths stuff",["Misc"]),s2t=sec2time
